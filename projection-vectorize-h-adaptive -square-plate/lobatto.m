function [N,shapelq,dhdnita,Nder,Nder_1,Nder1]=lobatto(x,p)

l(1)=1/2-1/2*x;
l(2)=1/2+1/2*x;
l(3)=1/2*6^(1/2)*(1/2*x^2-1/2);
l(4)=1/2*10^(1/2)*(1/2*x^2-1/2)*x;
l(5)=1/2*14^(1/2)*(1/8+(-3/4+5/8*x^2)*x^2);
l(6)=3/2*2^(1/2)*(3/8+(-5/4+7/8*x^2)*x^2)*x;
l(7)=1/2*22^(1/2)*(-1/16+(15/16+(-35/16+21/16*x^2)*x^2)*x^2);
l(8)=1/2*26^(1/2)*(-5/16+(35/16+(-63/16+33/16*x^2)*x^2)*x^2)*x;
l(9)=1/2*30^(1/2)*(5/128+(-35/32+(315/64+(-231/32+429/128*x^2)*x^2)*x^2)*x^2);
l(10)=1/2*34^(1/2)*(35/128+(-105/32+(693/64+(-429/32+715/128*x^2)*x^2)*x^2)*x^2)*x;
l(11)=1/2*38^(1/2)*(-7/256+(315/256+(-1155/128+(3003/128+(-6435/256+2431/256*x^2)*x^2)*x^2)*x^2)*x^2);
l(12)=1/2*42^(1/2)*(-63/256+(1155/256+(-3003/128+(6435/128+(-12155/256+4199/256*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(13)=1/2*46^(1/2)*(21/1024+(-693/512+(15015/1024+(-15015/256+(109395/1024+(-46189/512+29393/1024*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(14)=5/2*2^(1/2)*(231/1024+(-3003/512+(45045/1024+(-36465/256+(230945/1024+(-88179/512+52003/1024*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(15)=3/2*6^(1/2)*(-33/2048+(3003/2048+(-45045/2048+(255255/2048+(-692835/2048+(969969/2048+(-676039/2048+185725/2048*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(16)=1/2*58^(1/2)*(-429/2048+(15015/2048+(-153153/2048+(692835/2048+(-1616615/2048+(2028117/2048+(-1300075/2048+334305/2048*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(17)=1/2*62^(1/2)*(429/32768+(-6435/4096+(255255/8192+(-969969/4096+(14549535/16384+(-7436429/4096+(16900975/8192+(-5014575/4096+9694845/32768*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(18)=1/2*66^(1/2)*(6435/32768+(-36465/4096+(969969/8192+(-2909907/4096+(37182145/16384+(-16900975/4096+(35102025/8192+(-9694845/4096+17678835/32768*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(19)=1/2*70^(1/2)*(-715/65536+(109395/65536+(-692835/16384+(6789783/16384+(-66927861/32768+(185910725/32768+(-152108775/16384+(145422675/16384+(-300540195/65536+64822395/65536*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(20)=1/2*74^(1/2)*(-12155/65536+(692835/65536+(-2909907/16384+(22309287/16384+(-185910725/32768+(456326325/32768+(-339319575/16384+(300540195/16384+(-583401555/65536+119409675/65536*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(21)=1/2*78^(1/2)*(2431/262144+(-230945/131072+(14549535/262144+(-22309287/32768+(557732175/131072+(-1003917915/65536+(4411154475/131072+(-1502700975/32768+(9917826435/262144+(-2268783825/131072+883631595/262144*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(22)=1/2*82^(1/2)*(46189/262144+(-1616615/131072+(66927861/262144+(-79676025/32768+(1673196525/131072+(-2646692685/65536+(10518906825/131072+(-3305942145/32768+(20419054425/262144+(-4418157975/131072+1641030105/262144*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(23)=1/2*86^(1/2)*(-4199/524288+(969969/524288+(-37182145/524288+(557732175/524288+(-2151252675/262144+(9704539845/262144+(-27349157745/262144+(49589132175/262144+(-115707975075/524288+(83945001525/524288+(-34461632205/524288+6116566755/524288*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(24)=3/2*10^(1/2)*(-88179/524288+(7436429/524288+(-185910725/524288+(2151252675/524288+(-6931814175/262144+(27349157745/262144+(-69424785045/262144+(115707975075/262144+(-251835004575/524288+(172308161025/524288+(-67282234305/524288+11435320455/524288*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(25)=1/2*94^(1/2)*(29393/4194304+(-2028117/1048576+(185910725/2097152+(-1673196525/1048576+(62386327575/4194304+(-42977247885/524288+(300840735195/1048576+(-347123925225/524288+(4281195077775/4194304+(-1091285019825/1048576+(1412926920405/2097152+(-263012370465/1048576+171529806825/4194304*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(26)=7/2*2^(1/2)*(676039/4194304+(-16900975/1048576+(1003917915/2097152+(-6931814175/1048576+(214886239425/4194304+(-128931743655/524288+(809955825525/1048576+(-856239015555/524288+(9821565178425/4194304+(-2354878200675/1048576+(2893136075115/2097152+(-514589420475/1048576+322476036831/4194304*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(27)=1/2*102^(1/2)*(-52003/8388608+(16900975/8388608+(-456326325/4194304+(9704539845/4194304+(-214886239425/8388608+(1418249180205/8388608+(-1504203675975/2097152+(4281195077775/2097152+(-33393321606645/8388608+(44742685812825/8388608+(-20251952525805/4194304+(11835556670925/4194304+(-8061900920775/8388608+1215486600363/8388608*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(28)=1/2*106^(1/2)*(-1300075/8388608+(152108775/8388608+(-2646692685/4194304+(42977247885/4194304+(-787916211225/8388608+(4512611027925/8388608+(-4281195077775/2097152+(11131107202215/2097152+(-80536834463085/8388608+(101259762629025/8388608+(-43397041126725/4194304+(24185702762325/4194304+(-15801325804719/8388608+2295919134019/8388608*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(29)=1/2*110^(1/2)*(185725/33554432+(-35102025/16777216+(4411154475/33554432+(-27349157745/8388608+(1418249180205/33554432+(-5515413478575/16777216+(55655536011075/33554432+(-23852372576175/4194304+(456375395290815/33554432+(-384787097990295/16777216+(911337863661225/33554432+(-185423721177825/8388608+(395033145117975/33554432+(-61989816618513/16777216+17383387729001/33554432*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);
l(30)=1/2*114^(1/2)*(5014575/33554432+(-339319575/16777216+(27349157745/33554432+(-128931743655/8388608+(5515413478575/33554432+(-18551845337025/16777216+(166966608033225/33554432+(-65196485041545/4194304+(1154361293970885/33554432+(-911337863661225/16777216+(2039660932956075/33554432+(-395033145117975/8388608+(805867616040669/33554432+(-121683714103007/16777216+32968493968795/33554432*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
l(31)=1/2*118^(1/2)*(-334305/67108864+(145422675/67108864+(-10518906825/67108864+(300840735195/67108864+(-4512611027925/67108864+(40814059741455/67108864+(-241173989381325/67108864+(977947275623175/67108864+(-2803448856786435/67108864+(5771806469854425/67108864+(-8566575918415515/67108864+(9085762337713425/67108864+(-6715563467005575/67108864+(3285460280781189/67108864+(-956086325095055/67108864+125280277081421/67108864*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2);


lder(1)=-1/2;
lder(2)=1/2;
lder(3)=1/2*6^(1/2)*x;
lder(4)=-1/4*10^(1/2)+3/4*10^(1/2)*x^2;
lder(5)=1/2*14^(1/2)*(-3/2+5/2*x^2)*x;
lder(6)=9/16*2^(1/2)+(-45/8*2^(1/2)+105/16*2^(1/2)*x^2)*x^2;
lder(7)=1/2*22^(1/2)*(15/8+(-35/4+63/8*x^2)*x^2)*x;
lder(8)=-5/32*26^(1/2)+(105/32*26^(1/2)+(-315/32*26^(1/2)+231/32*26^(1/2)*x^2)*x^2)*x^2;
lder(9)=1/2*30^(1/2)*(-35/16+(315/16+(-693/16+429/16*x^2)*x^2)*x^2)*x;
lder(10)=35/256*34^(1/2)+(-315/64*34^(1/2)+(3465/128*34^(1/2)+(-3003/64*34^(1/2)+6435/256*34^(1/2)*x^2)*x^2)*x^2)*x^2;
lder(11)=1/2*38^(1/2)*(315/128+(-1155/32+(9009/64+(-6435/32+12155/128*x^2)*x^2)*x^2)*x^2)*x;
lder(12)=-63/512*42^(1/2)+(3465/512*42^(1/2)+(-15015/256*42^(1/2)+(45045/256*42^(1/2)+(-109395/512*42^(1/2)+46189/512*42^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(13)=1/2*46^(1/2)*(-693/256+(15015/256+(-45045/128+(109395/128+(-230945/256+88179/256*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(14)=1155/2048*2^(1/2)+(-45045/1024*2^(1/2)+(1126125/2048*2^(1/2)+(-1276275/512*2^(1/2)+(10392525/2048*2^(1/2)+(-4849845/1024*2^(1/2)+3380195/2048*2^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(15)=3/2*6^(1/2)*(3003/1024+(-45045/512+(765765/1024+(-692835/256+(4849845/1024+(-2028117/512+1300075/1024*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(16)=-429/4096*58^(1/2)+(45045/4096*58^(1/2)+(-765765/4096*58^(1/2)+(4849845/4096*58^(1/2)+(-14549535/4096*58^(1/2)+(22309287/4096*58^(1/2)+(-16900975/4096*58^(1/2)+5014575/4096*58^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(17)=1/2*62^(1/2)*(-6435/2048+(255255/2048+(-2909907/2048+(14549535/2048+(-37182145/2048+(50702925/2048+(-35102025/2048+9694845/2048*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(18)=6435/65536*66^(1/2)+(-109395/8192*66^(1/2)+(4849845/16384*66^(1/2)+(-20369349/8192*66^(1/2)+(334639305/32768*66^(1/2)+(-185910725/8192*66^(1/2)+(456326325/16384*66^(1/2)+(-145422675/8192*66^(1/2)+300540195/65536*66^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(19)=1/2*70^(1/2)*(109395/32768+(-692835/4096+(20369349/8192+(-66927861/4096+(929553625/16384+(-456326325/4096+(1017958725/8192+(-300540195/4096+583401555/32768*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(20)=-12155/131072*74^(1/2)+(2078505/131072*74^(1/2)+(-14549535/32768*74^(1/2)+(156165009/32768*74^(1/2)+(-1673196525/65536*74^(1/2)+(5019589575/65536*74^(1/2)+(-4411154475/32768*74^(1/2)+(4508102925/32768*74^(1/2)+(-9917826435/131072*74^(1/2)+2268783825/131072*74^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(21)=1/2*78^(1/2)*(-230945/65536+(14549535/65536+(-66927861/16384+(557732175/16384+(-5019589575/32768+(13233463425/32768+(-10518906825/16384+(9917826435/16384+(-20419054425/65536+4418157975/65536*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(22)=46189/524288*82^(1/2)+(-4849845/262144*82^(1/2)+(334639305/524288*82^(1/2)+(-557732175/65536*82^(1/2)+(15058768725/262144*82^(1/2)+(-29113619535/131072*82^(1/2)+(136745788725/262144*82^(1/2)+(-49589132175/65536*82^(1/2)+(347123925225/524288*82^(1/2)+(-83945001525/262144*82^(1/2)+34461632205/524288*82^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(23)=1/2*86^(1/2)*(969969/262144+(-37182145/131072+(1673196525/262144+(-2151252675/32768+(48522699225/131072+(-82047473235/65536+(347123925225/131072+(-115707975075/32768+(755505013725/262144+(-172308161025/131072+67282234305/262144*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(24)=-264537/1048576*10^(1/2)+(66927861/1048576*10^(1/2)+(-2788660875/1048576*10^(1/2)+(45176306175/1048576*10^(1/2)+(-187158982725/524288*10^(1/2)+(902522205585/524288*10^(1/2)+(-2707566616755/524288*10^(1/2)+(5206858878375/524288*10^(1/2)+(-12843585233325/1048576*10^(1/2)+(9821565178425/1048576*10^(1/2)+(-4238780761215/1048576*10^(1/2)+789037111395/1048576*10^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(25)=1/2*94^(1/2)*(-2028117/524288+(185910725/524288+(-5019589575/524288+(62386327575/524288+(-214886239425/262144+(902522205585/262144+(-2429867476575/262144+(4281195077775/262144+(-9821565178425/524288+(7064634602025/524288+(-2893136075115/524288+514589420475/524288*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(26)=4732273/8388608*2^(1/2)+(-354920475/2097152*2^(1/2)+(35137127025/4194304*2^(1/2)+(-339658894575/2097152*2^(1/2)+(13537833083775/8388608*2^(1/2)+(-9927744261435/1048576*2^(1/2)+(73705980122775/2097152*2^(1/2)+(-89905096633275/1048576*2^(1/2)+(1168766256232575/8388608*2^(1/2)+(-313198800689775/2097152*2^(1/2)+(425291003041905/4194304*2^(1/2)+(-82848896696475/2097152*2^(1/2)+56433306445425/8388608*2^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(27)=1/2*102^(1/2)*(16900975/4194304+(-456326325/1048576+(29113619535/2097152+(-214886239425/1048576+(7091245901025/4194304+(-4512611027925/524288+(29968365544425/1048576+(-33393321606645/524288+(402684172315425/4194304+(-101259762629025/1048576+(130191123380175/2097152+(-24185702762325/1048576+15801325804719/4194304*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(28)=-1300075/16777216*106^(1/2)+(456326325/16777216*106^(1/2)+(-13233463425/8388608*106^(1/2)+(300840735195/8388608*106^(1/2)+(-7091245901025/16777216*106^(1/2)+(49638721307175/16777216*106^(1/2)+(-55655536011075/4194304*106^(1/2)+(166966608033225/4194304*106^(1/2)+(-1369126185872445/16777216*106^(1/2)+(1923935489951475/16777216*106^(1/2)+(-911337863661225/8388608*106^(1/2)+(556271163533475/8388608*106^(1/2)+(-395033145117975/16777216*106^(1/2)+61989816618513/16777216*106^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(29)=1/2*110^(1/2)*(-35102025/8388608+(4411154475/8388608+(-82047473235/4194304+(1418249180205/4194304+(-27577067392875/8388608+(166966608033225/8388608+(-166966608033225/2097152+(456375395290815/2097152+(-3463083881912655/8388608+(4556689318306125/8388608+(-2039660932956075/4194304+(1185099435353925/4194304+(-805867616040669/8388608+121683714103007/8388608*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;
lder(30)=5014575/67108864*114^(1/2)+(-1017958725/33554432*114^(1/2)+(136745788725/67108864*114^(1/2)+(-902522205585/16777216*114^(1/2)+(49638721307175/67108864*114^(1/2)+(-204070298707275/33554432*114^(1/2)+(2170565904431925/67108864*114^(1/2)+(-977947275623175/8388608*114^(1/2)+(19624141997505045/67108864*114^(1/2)+(-17315419409563275/33554432*114^(1/2)+(42832879592077575/67108864*114^(1/2)+(-9085762337713425/16777216*114^(1/2)+(20146690401016725/67108864*114^(1/2)+(-3285460280781189/33554432*114^(1/2)+956086325095055/67108864*114^(1/2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2;
lder(31)=1/2*118^(1/2)*(145422675/33554432+(-10518906825/16777216+(902522205585/33554432+(-4512611027925/8388608+(204070298707275/33554432+(-723521968143975/16777216+(6845630929362225/33554432+(-2803448856786435/4194304+(51946258228689825/33554432+(-42832879592077575/16777216+(99943385714847675/33554432+(-20146690401016725/8388608+(42710983650155457/33554432+(-6692604275665385/16777216+1879204156221315/33554432*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x^2)*x;

shapelq= [l(1)]; N= [l(1) 0;0 l(1)]; dhdnita= [lder(1)]; Nder= [lder(1) 0;0 lder(1)];
for j=2:p
    shapelq = [shapelq l(j+1)];
    N = [N [l(j+1) 0;0 l(j+1)]];
    dhdnita = [dhdnita lder(j+1)];
    Nder = [Nder [lder(j+1) 0;0 lder(j+1)]];
end
    
shapelq = [shapelq l(2)];
N = [N [l(2) 0;0 l(2)]];
dhdnita = [dhdnita lder(2)];
Nder = [Nder [lder(2) 0;0 lder(2)]];

Nder_1 = [dhdnita(1) 0;0 dhdnita(1)];
Nder1 = [0 0;0 0];
n= length(dhdnita);
for i=2:n
    Nder_1 = [Nder_1 [0 0;0 0]];
end   

for i=2:(n-1)
   Nder1 = [Nder1 [0 0;0 0]];
end
Nder1 = [Nder1 [dhdnita(n) 0;0 dhdnita(n)]];